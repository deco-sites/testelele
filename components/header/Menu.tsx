import Icon from "deco-sites/fashion/components/ui/Icon.tsx";
import Text from "deco-sites/fashion/components/ui/Text.tsx";
import Button from "deco-sites/fashion/components/ui/Button.tsx";
import { useSignal } from "@preact/signals";
import type { INavItem } from "./NavItem.tsx";
import Image from "deco-sites/std/components/Image.tsx";

export interface Props {
  items: INavItem[];
}

function MenuItem({ item, level = 0 }: { item: INavItem; level?: number }) {
  const open = useSignal(false);
  const hasChildren = Array.isArray(item.children) && item.children.length > 0;

  const title = (
    <Text
      class="flex-grow min-h-[40px] flex items-center justify-start"
      variant={level === 0 ? "menu" : "caption"}
    >
      {item.label}
    </Text>
  );

  return (
    <li>
      <div
        class={`flex justify-between items-center w-full py-2 ${
          level > 0 ? "pl-2" : ""
        }`}
        onClick={() => {
          if (hasChildren) open.value = !open.value;
        }}
      >
        <div class="flex gap-2">
          {item.image && (
            <Image
              src={item.image.src}
              width={24}
              height={24}
              alt={item.image.alt}
            />
          )}
          <div class="flex items-center gap-2">
            {hasChildren
              ? title
              : <a class="w-full inline-block" href={item.href}>{title}</a>}
          </div>
        </div>

        {hasChildren
          ? (
            <Button variant="icon">
              <Icon
                class=""
                id="ChevronRight"
                height={9}
                width={9}
                strokeWidth={5}
              />
            </Button>
          )
          : <div />}
      </div>

      {hasChildren && (
        <ul class={`flex-col ${open.value === true ? "flex" : "hidden"}`}>
          <li>
            <a href={item.href} class="w-full py-2 pl-2 inline-block">
              <Text class="underline" variant="caption">
                Ver todos
              </Text>
            </a>
          </li>
          {item.children!.map((node) => (
            <MenuItem
              item={node}
              level={level + 1}
            />
          ))}
        </ul>
      )}
    </li>
  );
}

function Menu({ items }: Props) {
  return (
    <>
      <ul class="px-4 flex-grow flex flex-col border-b-[10px] border-[#f9f9f9]">
        {items.map((item) => <MenuItem item={item} />)}
      </ul>
      <ul class="flex flex-col py-2">
        <h2 class="p-4 text-xl text-gray-icon">
          <Text variant="heading-2">Seviços</Text>
        </h2>
        <li>
          <a
            class="flex items-center gap-4 px-4 py-2"
            href="#"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0)">
                <path
                  d="M17.2257 14.1503C16.8572 13.7666 16.4127 13.5615 15.9416 13.5615C15.4743 13.5615 15.0261 13.7628 14.6424 14.1465L13.4419 15.3432C13.3431 15.29 13.2443 15.2407 13.1493 15.1913C13.0126 15.1229 12.8834 15.0583 12.7732 14.9899C11.6487 14.2757 10.6268 13.3449 9.64664 12.1407C9.17176 11.5404 8.85264 11.0351 8.6209 10.5223C8.93242 10.2373 9.22115 9.94102 9.50228 9.65609C9.60865 9.54972 9.71502 9.43955 9.82139 9.33318C10.6192 8.53538 10.6192 7.50205 9.82139 6.70425L8.78426 5.66712C8.66649 5.54935 8.54492 5.42778 8.43095 5.30621C8.20301 5.07067 7.96367 4.82754 7.71673 4.59959C7.34823 4.23489 6.90754 4.04114 6.44406 4.04114C5.98058 4.04114 5.5323 4.23489 5.15239 4.59959C5.14859 4.60339 5.14859 4.60339 5.1448 4.60719L3.85313 5.91026C3.36685 6.39653 3.08952 6.98918 3.02874 7.6768C2.93756 8.78612 3.26428 9.81945 3.51501 10.4957C4.13046 12.1559 5.04982 13.6945 6.42127 15.3432C8.08524 17.3301 10.0873 18.8991 12.3743 20.0046C13.2481 20.4187 14.4144 20.9088 15.7175 20.9924C15.7973 20.9962 15.8808 21 15.9568 21C16.8344 21 17.5714 20.6847 18.1489 20.0578C18.1527 20.0502 18.1602 20.0464 18.164 20.0388C18.3616 19.7995 18.5895 19.5829 18.8289 19.3512C18.9922 19.1954 19.1594 19.0321 19.3228 18.8611C19.6989 18.4698 19.8964 18.0139 19.8964 17.5467C19.8964 17.0756 19.6951 16.6235 19.3114 16.2436L17.2257 14.1503ZM18.5857 18.1507C18.5819 18.1507 18.5819 18.1545 18.5857 18.1507C18.4376 18.3103 18.2856 18.4546 18.1223 18.6142C17.8753 18.8497 17.6246 19.0967 17.389 19.374C17.0053 19.7843 16.5533 19.978 15.9606 19.978C15.9036 19.978 15.8428 19.978 15.7859 19.9742C14.6575 19.9021 13.609 19.4614 12.8226 19.0853C10.6724 18.0443 8.78426 16.5665 7.21526 14.6936C5.9198 13.1322 5.05362 11.6886 4.47997 10.1386C4.12666 9.19261 3.99749 8.4556 4.05448 7.76038C4.09247 7.3159 4.26342 6.94739 4.57874 6.63207L5.87421 5.3366C6.06036 5.16185 6.25791 5.06687 6.45166 5.06687C6.691 5.06687 6.88475 5.21124 7.00632 5.33281C7.01012 5.3366 7.01392 5.3404 7.01771 5.3442C7.24945 5.56075 7.4698 5.78489 7.70154 6.02423C7.81931 6.1458 7.94088 6.26737 8.06245 6.39273L9.09958 7.42987C9.50227 7.83256 9.50227 8.20487 9.09958 8.60756C8.98941 8.71774 8.88303 8.82791 8.77286 8.93428C8.45374 9.26099 8.14982 9.56492 7.81931 9.86124C7.81171 9.86884 7.80411 9.87264 7.80031 9.88024C7.4736 10.207 7.53438 10.5261 7.60276 10.7426C7.60656 10.754 7.61036 10.7654 7.61416 10.7768C7.88389 11.4302 8.26379 12.0457 8.84125 12.7789L8.84504 12.7827C9.89357 14.0744 10.9991 15.0811 12.2186 15.8523C12.3743 15.9511 12.5339 16.0309 12.6859 16.1068C12.8226 16.1752 12.9518 16.2398 13.062 16.3082C13.0772 16.3158 13.0924 16.3272 13.1075 16.3348C13.2367 16.3994 13.3583 16.4298 13.4837 16.4298C13.799 16.4298 13.9965 16.2322 14.0611 16.1676L15.3604 14.8684C15.4895 14.7392 15.6947 14.5834 15.934 14.5834C16.1696 14.5834 16.3633 14.7316 16.4811 14.8608C16.4849 14.8646 16.4849 14.8646 16.4887 14.8684L18.5819 16.9616C18.9732 17.3491 18.9732 17.748 18.5857 18.1507Z"
                  fill="#ED1B2F"
                >
                </path>
                <path
                  d="M12.7276 7.28169C13.7229 7.44885 14.6271 7.91992 15.3489 8.64174C16.0707 9.36355 16.538 10.2677 16.7089 11.2631C16.7507 11.5138 16.9673 11.6886 17.2142 11.6886C17.2446 11.6886 17.2712 11.6848 17.3016 11.681C17.5827 11.6354 17.7689 11.3694 17.7233 11.0883C17.5181 9.88402 16.9483 8.7861 16.0783 7.91613C15.2083 7.04615 14.1104 6.4763 12.9061 6.27115C12.625 6.22556 12.3629 6.41171 12.3135 6.68904C12.2641 6.96637 12.4464 7.2361 12.7276 7.28169Z"
                  fill="#ED1B2F"
                >
                </path>
                <path
                  d="M20.9791 10.9401C20.641 8.95706 19.7064 7.15252 18.2704 5.71649C16.8344 4.28046 15.0298 3.3459 13.0467 3.00779C12.7694 2.9584 12.5073 3.14835 12.4579 3.42568C12.4123 3.70681 12.5984 3.96894 12.8796 4.01833C14.6499 4.31845 16.2645 5.15804 17.5486 6.43831C18.8326 7.72238 19.6684 9.33696 19.9686 11.1073C20.0103 11.358 20.2269 11.5328 20.4738 11.5328C20.5042 11.5328 20.5308 11.529 20.5612 11.5252C20.8385 11.4834 21.0285 11.2175 20.9791 10.9401Z"
                  fill="#ED1B2F"
                >
                </path>
              </g>
              <defs>
                <clipPath id="clip0">
                  <rect
                    width="18"
                    height="18"
                    fill="white"
                    transform="translate(3 3)"
                  >
                  </rect>
                </clipPath>
              </defs>
            </svg>
            <Text variant="caption">Central de atendimento</Text>
          </a>
        </li>
        <li>
          <a
            class="flex items-center gap-4 px-4 py-2"
            href="https://www.deco.cx"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.60891 4.29822C8.84306 4.06925 9.21596 4.067 9.45285 4.29312L12.2179 6.93275L14.8334 4.31124C15.0708 4.07322 15.4558 4.07322 15.6933 4.31124L21.1969 9.82779C21.4302 10.0616 21.4349 10.4393 21.2074 10.6789L12.6565 19.6857C12.4222 19.9324 12.0318 19.9388 11.7896 19.7L2.8066 10.8412C2.56375 10.6017 2.56458 10.209 2.80843 9.97051L4.43149 8.38332C4.323 8.24097 4.22231 8.09424 4.13355 7.94495C3.91669 7.58019 3.75645 7.1759 3.74873 6.76771C3.74073 6.34482 3.8976 5.94192 4.26735 5.60836C4.63103 5.28027 5.03873 5.15019 5.45198 5.17006C5.85473 5.18941 6.24244 5.34976 6.588 5.56445C6.73234 5.65411 6.8727 5.7554 7.00763 5.86411L8.60891 4.29822ZM7.02465 6.69894C7.30335 6.97839 7.54343 7.27775 7.716 7.53061L8.21782 7.18644C8.03167 6.91374 7.77019 6.58516 7.45991 6.27331L9.03352 4.73446L11.7986 7.37409C12.0376 7.60224 12.4145 7.59762 12.6479 7.3637L15.2633 4.74219L20.767 10.2587L12.216 19.2656L3.23303 10.4067L4.82591 8.84907C5.15809 9.206 5.51396 9.51406 5.80838 9.73542L6.17321 9.24785C5.89451 9.03834 5.56395 8.74996 5.26125 8.42337L7.02465 6.69894ZM6.56876 6.29326C6.47048 6.21687 6.36983 6.14592 6.26768 6.08247C5.97349 5.8997 5.68669 5.79151 5.42284 5.7788C5.16941 5.76665 4.91843 5.84094 4.67408 6.06136C4.4358 6.27635 4.35199 6.50956 4.35664 6.75612C4.36159 7.01742 4.46738 7.31589 4.65589 7.63295C4.72013 7.74106 4.79231 7.84854 4.87028 7.95421L6.56876 6.29326Z"
                fill="#EC1B2F"
              >
              </path>
              <path
                d="M6.44622 9.49224C6.44622 9.74469 6.24203 9.94933 5.99018 9.94933C5.73833 9.94933 5.53418 9.74469 5.53418 9.49224C5.53418 9.23979 5.73833 9.03516 5.99018 9.03516C6.24203 9.03516 6.44622 9.23979 6.44622 9.49224Z"
                fill="#EC1B2F"
              >
              </path>
              <path
                d="M8.42278 7.35748C8.42278 7.60993 8.21863 7.81457 7.96678 7.81457C7.71489 7.81457 7.51074 7.60993 7.51074 7.35748C7.51074 7.10503 7.71489 6.90039 7.96678 6.90039C8.21863 6.90039 8.42278 7.10503 8.42278 7.35748Z"
                fill="#EC1B2F"
              >
              </path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.47781 4.16415C8.78419 3.86456 9.27232 3.8616 9.5823 4.15751L12.2148 6.67046L14.7006 4.17877C15.0114 3.86733 15.5153 3.86733 15.826 4.17877L21.3297 9.69532C21.6347 10.0011 21.6408 10.4947 21.3434 10.8079L12.7924 19.8148C12.486 20.1376 11.9748 20.146 11.6579 19.8335L2.67494 10.9747C2.35742 10.6615 2.35849 10.1482 2.67733 9.83643L4.18372 8.36336C4.10846 8.25802 4.03751 8.15028 3.97237 8.04075C3.7468 7.66132 3.56984 7.22452 3.56126 6.77122C3.55224 6.2943 3.73149 5.83923 4.14172 5.46915C4.54222 5.10787 4.9983 4.9605 5.46097 4.98277C5.90666 5.00418 6.32557 5.18066 6.68692 5.40517C6.79174 5.47027 6.89411 5.54092 6.99356 5.61558L8.47781 4.16415ZM9.32336 4.42875C9.1596 4.27241 8.9019 4.27395 8.74001 4.43227L7.01962 6.1146L6.88995 6.01008C6.76016 5.9055 6.62602 5.80878 6.48904 5.7237C6.15934 5.51887 5.80279 5.37465 5.44294 5.35732C5.07915 5.33985 4.71982 5.45268 4.39294 5.74758C4.06369 6.04458 3.92921 6.39536 3.93619 6.76413C3.94305 7.12721 4.0866 7.49902 4.29472 7.84912C4.37929 7.99136 4.47577 8.13213 4.58062 8.26961L4.68112 8.40146L2.93952 10.1046C2.77066 10.2697 2.77008 10.5418 2.93826 10.7077L11.9212 19.5665C12.0887 19.7316 12.3585 19.7272 12.5205 19.5566L21.0714 10.5498C21.229 10.3839 21.2257 10.1221 21.0642 9.96018L15.5605 4.44363C15.3963 4.27905 15.1303 4.27905 14.9661 4.44363L12.2212 7.19501L9.32336 4.42875ZM9.03195 4.47375L11.9281 7.23847C12.0933 7.3962 12.3538 7.39301 12.5152 7.23127L15.2633 4.47667L21.0286 10.2555L12.2204 19.5332L2.96543 10.4062L4.83221 8.58063L4.96316 8.72133C5.1159 8.88547 5.27392 9.03907 5.42827 9.1782C5.46667 9.10927 5.5173 9.04811 5.57722 8.99767C5.42546 8.86057 5.27141 8.71016 5.1237 8.55082L4.99961 8.41695L7.0263 6.43503L7.15744 6.56651C7.27534 6.68475 7.38652 6.8064 7.48897 6.92681C7.54132 6.86872 7.6041 6.8202 7.67434 6.7842C7.56787 6.65857 7.45147 6.53062 7.32697 6.40552L7.19359 6.27146L9.03195 4.47375ZM7.92041 7.09297C7.8387 7.1073 7.76947 7.15875 7.73096 7.22958C7.74154 7.24365 7.75192 7.25767 7.76212 7.27158L7.95484 7.13943C7.94355 7.12406 7.93207 7.10857 7.92041 7.09297ZM7.91314 7.62273L8.23151 7.40441C8.2098 7.53172 8.09925 7.62813 7.96687 7.62813C7.94846 7.62813 7.9305 7.62626 7.91314 7.62273ZM7.32465 7.31707C7.32379 7.33076 7.32334 7.3446 7.32334 7.35855C7.32334 7.71412 7.61104 8.00313 7.96687 8.00313C8.32267 8.00313 8.61037 7.71412 8.61037 7.35855C8.61037 7.05405 8.3994 6.79833 8.11534 6.73117C7.99875 6.58338 7.8675 6.42945 7.72425 6.27701L9.03506 4.99518L11.6692 7.50971C11.9819 7.80825 12.4753 7.80221 12.7806 7.49613L15.2633 5.00763L20.5053 10.2619L12.2116 18.9978L3.50064 10.4073L4.82137 9.11576C5.00122 9.29921 5.18452 9.4677 5.35916 9.61586C5.41695 9.91215 5.67746 10.1362 5.99074 10.1362C6.34657 10.1362 6.63427 9.8472 6.63427 9.49162C6.63427 9.13601 6.34657 8.84703 5.99074 8.84703C5.98515 8.84703 5.9796 8.84707 5.97405 8.84722C5.82664 8.72122 5.67367 8.57981 5.52472 8.42797L7.02079 6.96495C7.13047 7.08243 7.23251 7.2015 7.32465 7.31707ZM5.8716 9.24997C5.79945 9.28589 5.74556 9.35343 5.7282 9.43477C5.74305 9.44685 5.75782 9.4587 5.77249 9.4704L5.9127 9.28305C5.89909 9.27217 5.88536 9.26115 5.8716 9.24997ZM6.02486 9.75903L6.25609 9.45003C6.25819 9.46357 6.25927 9.47745 6.25927 9.49162C6.25927 9.62925 6.15675 9.74223 6.02486 9.75903ZM5.4138 5.9661C5.20984 5.95627 5.00726 6.01335 4.7997 6.20058C4.60189 6.37901 4.54046 6.56006 4.54414 6.75258C4.54822 6.96877 4.63725 7.23472 4.81702 7.53712C4.84245 7.57991 4.8693 7.6227 4.89739 7.66545L6.27941 6.31395C6.24262 6.28882 6.20572 6.26471 6.16871 6.24172C5.89039 6.06881 5.63479 5.97671 5.4138 5.9661ZM4.54849 5.92215C4.82962 5.66853 5.12899 5.57696 5.43184 5.59151C5.73862 5.60628 6.05659 5.7306 6.3666 5.9232C6.47501 5.99051 6.58106 6.06532 6.68381 6.1452L6.8535 6.27705L4.84732 8.23893L4.71941 8.0655C4.63826 7.95551 4.56255 7.8429 4.49471 7.72875C4.29746 7.39702 4.17499 7.06605 4.16917 6.75967C4.16351 6.459 4.26971 6.17362 4.54849 5.92215Z"
                fill="#EC1B2F"
              >
              </path>
            </svg>
            <Text variant="caption">Clube minha le</Text>
          </a>
        </li>
        <li>
          <a
            class="flex items-center gap-4 px-4 py-2"
            href="https://www.deco.cx"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M4.17391 5.75H19.8261C20.1983 5.75 20.5 6.05166 20.5 6.42391V17.3804C20.5 17.7527 20.1983 18.0543 19.8261 18.0543H4.17391C3.80166 18.0543 3.5 17.7527 3.5 17.3804V6.42391C3.5 6.05166 3.80166 5.75 4.17391 5.75Z"
                stroke="#EC1B2F"
              >
              </path>
              <rect x="3" y="8.625" width="18" height="3.375" fill="#EC1B2F">
              </rect>
            </svg>
            <Text variant="caption">Cartão Le biscuit</Text>
          </a>
        </li>
        <li>
          <a
            class="flex items-center gap-4 px-4 py-2"
            href="https://www.deco.cx"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M20.4434 14.207H17.6602V3.55664C17.6602 3.24918 17.411 3 17.1035 3H2.55664C2.24918 3 2 3.24918 2 3.55664V19.2168C2 20.7515 3.24853 22 4.7832 22H18.7734C20.0012 22 21 21.0012 21 19.7734V14.7637C21 14.4562 20.7508 14.207 20.4434 14.207ZM3.11328 19.2168V4.11328H16.5469V19.7734C16.5469 20.1789 16.6563 20.559 16.8464 20.8867H4.7832C3.86243 20.8867 3.11328 20.1376 3.11328 19.2168ZM19.8867 19.7734C19.8867 20.3873 19.3873 20.8867 18.7734 20.8867C18.1595 20.8867 17.6602 20.3873 17.6602 19.7734V15.3203H19.8867V19.7734Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M14.877 5.22656H4.7832C4.47575 5.22656 4.22656 5.47575 4.22656 5.7832V10.3105C4.22656 10.618 4.47575 10.8672 4.7832 10.8672H14.877C15.1844 10.8672 15.4336 10.618 15.4336 10.3105V5.7832C15.4336 5.47575 15.1844 5.22656 14.877 5.22656ZM14.3203 9.75391H5.33984V6.33984H14.3203V9.75391Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M4.7832 17.5469H9.31055C9.618 17.5469 9.86719 17.2977 9.86719 16.9902V12.5371C9.86719 12.2297 9.618 11.9805 9.31055 11.9805H4.7832C4.47575 11.9805 4.22656 12.2297 4.22656 12.5371V16.9902C4.22656 17.2977 4.47575 17.5469 4.7832 17.5469ZM5.33984 13.0938H8.75391V16.4336H5.33984V13.0938Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M14.877 11.9805H11.5371C11.2297 11.9805 10.9805 12.2297 10.9805 12.5371C10.9805 12.8446 11.2297 13.0938 11.5371 13.0938H14.877C15.1844 13.0938 15.4336 12.8446 15.4336 12.5371C15.4336 12.2297 15.1844 11.9805 14.877 11.9805Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M14.877 14.207H11.5371C11.2297 14.207 10.9805 14.4562 10.9805 14.7637C10.9805 15.0711 11.2297 15.3203 11.5371 15.3203H14.877C15.1844 15.3203 15.4336 15.0711 15.4336 14.7637C15.4336 14.4562 15.1844 14.207 14.877 14.207Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M14.877 16.4336H11.5371C11.2297 16.4336 10.9805 16.6828 10.9805 16.9902C10.9805 17.2977 11.2297 17.5469 11.5371 17.5469H14.877C15.1844 17.5469 15.4336 17.2977 15.4336 16.9902C15.4336 16.6828 15.1844 16.4336 14.877 16.4336Z"
                fill="#ED1B2F"
              >
              </path>
              <path
                d="M14.877 18.6602H4.7832C4.47575 18.6602 4.22656 18.9093 4.22656 19.2168C4.22656 19.5243 4.47575 19.7734 4.7832 19.7734H14.877C15.1844 19.7734 15.4336 19.5243 15.4336 19.2168C15.4336 18.9093 15.1844 18.6602 14.877 18.6602Z"
                fill="#ED1B2F"
              >
              </path>
            </svg>
            <Text variant="caption">Blog da Le</Text>
          </a>
        </li>
        <li>
          <a
            class="flex items-center gap-4 px-4 py-2"
            href="https://www.deco.cx"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M20 7H4C2.89543 7 2 7.89543 2 9V19C2 20.1046 2.89543 21 4 21H20C21.1046 21 22 20.1046 22 19V9C22 7.89543 21.1046 7 20 7Z"
                stroke="#ED1B2F"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
              </path>
              <path
                d="M16 21V5C16 4.46957 15.7893 3.96086 15.4142 3.58579C15.0391 3.21071 14.5304 3 14 3H10C9.46957 3 8.96086 3.21071 8.58579 3.58579C8.21071 3.96086 8 4.46957 8 5V21"
                stroke="#ED1B2F"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
              </path>
            </svg>
            <Text variant="caption">Le consultores</Text>
          </a>
        </li>
      </ul>
    </>
  );
}

export default Menu;
